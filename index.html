<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Sa√∫de P√∫blica - Parauapebas/PA</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .timestamp {
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 25px;
            display: inline-block;
            backdrop-filter: blur(10px);
        }

        /* Se√ß√£o de Filtros */
        .filters-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            margin-bottom: 25px;
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #4a5568;
            font-size: 0.9rem;
        }

        .filter-group select,
        .filter-group input {
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 0.95rem;
            transition: all 0.2s;
            background: white;
        }

        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-input {
            position: relative;
        }

        .search-input::before {
            content: "üîç";
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 1;
        }

        .search-input input {
            padding-left: 40px;
        }

        .clear-btn {
            background: #f56565;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            align-self: end;
        }

        .clear-btn:hover {
            background: #e53e3e;
            transform: translateY(-2px);
        }

        .filter-stats {
            background: #f7fafc;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            font-weight: 600;
            color: #4a5568;
        }

        /* Sistema de Abas */
        .tabs-wrapper {
            display: grid;
            grid-template-columns: 260px 1fr;
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            overflow: hidden;
            min-height: 600px;
        }

        .tabs-nav {
            background: #f8fafc;
            border-right: 2px solid #e2e8f0;
            display: flex;
            flex-direction: column;
            padding: 20px 0;
            gap: 5px;
        }

        .tab-btn {
            background: transparent;
            border: none;
            padding: 18px 20px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s;
            border-left: 4px solid transparent;
            display: flex;
            align-items: center;
            gap: 10px;
            text-align: left;
            color: #4a5568;
        }

        .tab-btn:hover {
            background: rgba(102, 126, 234, 0.08);
            color: #667eea;
        }

        .tab-btn.active {
            background: rgba(102, 126, 234, 0.15);
            color: #667eea;
            border-left-color: #667eea;
        }

        .tabs-content {
            padding: 30px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards de Indicadores */
        .indicators-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
        }

        .indicator-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            border-left: 5px solid #667eea;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .indicator-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: linear-gradient(45deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
            border-radius: 0 0 0 100px;
        }

        .indicator-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2d3748;
            line-height: 1.4;
            flex: 1;
            margin-right: 10px;
        }

        .card-icon {
            font-size: 2rem;
            opacity: 0.8;
        }

        .card-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 8px;
        }

        .card-unit {
            font-size: 0.9rem;
            color: #718096;
            margin-bottom: 15px;
        }

        .card-source {
            font-size: 0.8rem;
            color: #a0aec0;
            font-style: italic;
        }

        .card-subcategory {
            display: inline-block;
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        /* Estilos espec√≠ficos para a Vis√£o Geral */
        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .overview-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            transition: all 0.3s;
            border-top: 4px solid #667eea;
        }

        .overview-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .overview-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.8;
        }

        .overview-title {
            font-size: 1rem;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 10px;
        }

        .overview-value {
            font-size: 2rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 5px;
        }

        .overview-unit {
            font-size: 0.9rem;
            color: #718096;
        }

        .category-section {
            margin-bottom: 40px;
        }

        .category-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .category-icon {
            font-size: 1.8rem;
        }

        .trend-indicator {
            display: inline-flex;
            align-items: center;
            font-size: 0.85rem;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 12px;
            margin-left: 10px;
        }

        .trend-up {
            background: rgba(72, 187, 120, 0.1);
            color: #38a169;
        }

        .trend-down {
            background: rgba(245, 101, 101, 0.1);
            color: #e53e3e;
        }

        .trend-stable {
            background: rgba(237, 137, 54, 0.1);
            color: #dd6b20;
        }

        /* Cores por categoria */
        .categoria-ibge {
            border-left-color: #f56565;
        }
        .categoria-ibge .card-value {
            color: #f56565;
        }

        .categoria-aps {
            border-left-color: #48bb78;
        }
        .categoria-aps .card-value {
            color: #48bb78;
        }

        .categoria-mac {
            border-left-color: #ed8936;
        }
        .categoria-mac .card-value {
            color: #ed8936;
        }

        .categoria-redes {
            border-left-color: #9f7aea;
        }
        .categoria-redes .card-value {
            color: #9f7aea;
        }

        /* Estados especiais */
        .loading-state, .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #718096;
        }

        .loading-state.show, .no-results.show {
            display: block;
        }

        .loading-state {
            display: none;
        }

        .no-results {
            display: none;
        }

        .no-results-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsividade */
        @media (max-width: 1024px) {
            .tabs-wrapper {
                grid-template-columns: 1fr;
            }

            .tabs-nav {
                flex-direction: row;
                overflow-x: auto;
                border-right: none;
                border-bottom: 2px solid #e2e8f0;
                padding: 10px;
            }

            .tab-btn {
                border-left: none;
                border-bottom: 3px solid transparent;
                min-width: 220px;
                justify-content: center;
            }

            .tab-btn.active {
                border-bottom-color: #667eea;
            }

            .tabs-content {
                padding: 20px;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .filters-grid {
                grid-template-columns: 1fr;
            }

            .indicators-grid {
                grid-template-columns: 1fr;
            }

            .overview-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Cabe√ßalho -->
        <header class="header">
            <h1>üè• Dashboard de Sa√∫de P√∫blica</h1>
            <p>Parauapebas - Par√° | Indicadores e M√©tricas de Sa√∫de de Parauapebas</p>
            <div class="timestamp">
                ‚è∞ √öltima atualiza√ß√£o: <span id="currentTime"></span>
            </div>
        </header>

        <!-- Se√ß√£o de Filtros -->
        <div class="filters-section">
            <div class="filters-grid">
                <div class="filter-group">
                    <label for="categoryFilter">Categoria:</label>
                    <select id="categoryFilter">
                        <option value="">Todas as Categorias</option>
                        <option value="IBGE">IBGE - Popula√ß√£o</option>
                        <option value="Aten√ß√£o Prim√°ria (APS)">Aten√ß√£o Prim√°ria (APS)</option>
                        <option value="M√©dia e Alta Complexidade (MAC)">M√©dia e Alta Complexidade (MAC)</option>
                        <option value="Redes de Aten√ß√£o / Integra√ß√£o">Redes de Aten√ß√£o / Integra√ß√£o</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label for="subcategoryFilter">Sub-categoria:</label>
                    <select id="subcategoryFilter">
                        <option value="">Todas as Sub-categorias</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label for="sourceFilter">Fonte de Dados:</label>
                    <select id="sourceFilter">
                        <option value="">Todas as Fontes</option>
                        <option value="PEC">PEC</option>
                        <option value="IBGE">IBGE</option>
                        <option value="SIA">SIA</option>
                        <option value="SIM">SIM</option>
                        <option value="SAI">SAI</option>
                        <option value="SAMU">SAMU</option>
                        <option value="HGP">HGP</option>
                        <option value="DIRCA">DIRCA</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label for="dateFilter">Per√≠odo (Data de Refer√™ncia):</label>
                    <input type="date" id="dateFilter">
                </div>

                <div class="filter-group">
                    <label for="searchFilter">Buscar Indicador:</label>
                    <div class="search-input">
                        <input type="text" id="searchFilter" placeholder="Digite o nome do indicador...">
                    </div>
                </div>

                <div class="filter-group">
                    <button class="clear-btn" onclick="clearAllFilters()">
                        üóëÔ∏è Limpar Filtros
                    </button>
                </div>
            </div>

            <div class="filter-stats" id="filterStats">
                üìä Carregando estat√≠sticas...
            </div>
        </div>

        <!-- Sistema de Abas -->
        <div class="tabs-wrapper">
            <div class="tabs-nav">
                <button class="tab-btn active" onclick="switchTab('overview', this)">
                    üìà Vis√£o Geral
                </button>
                <button class="tab-btn" onclick="switchTab('ibge', this)">
                    üìä Popula√ß√£o (IBGE)
                </button>
                <button class="tab-btn" onclick="switchTab('aps', this)">
                    üè° Aten√ß√£o Prim√°ria (APS)
                </button>
                <button class="tab-btn" onclick="switchTab('mac', this)">
                    üè• M√©dia e Alta Complexidade
                </button>
                <button class="tab-btn" onclick="switchTab('redes', this)">
                    üîó Redes de Aten√ß√£o / Integra√ß√£o
                </button>
            </div>

            <div class="tabs-content">
                <!-- Estado de carregamento -->
                <div class="loading-state" id="loadingState">
                    <div class="spinner"></div>
                    <p>Carregando indicadores de sa√∫de...</p>
                </div>

                <!-- Sem resultados -->
                <div class="no-results" id="noResults">
                    <div class="no-results-icon">üîç</div>
                    <h3>Nenhum indicador encontrado</h3>
                    <p>Tente ajustar os filtros para encontrar os indicadores desejados.</p>
                </div>

                <!-- Conte√∫do das Abas -->
                <div id="overview" class="tab-content active">
                    <div class="overview-grid" id="overviewGrid">
                        <!-- Cards de resumo ser√£o inseridos aqui via JavaScript -->
                    </div>

                    <div class="category-section" id="ibgeOverview">
                        <!-- Conte√∫do da categoria IBGE ser√° inserido aqui via JavaScript -->
                    </div>

                    <div class="category-section" id="apsOverview">
                        <!-- Conte√∫do da categoria APS ser√° inserido aqui via JavaScript -->
                    </div>

                    <div class="category-section" id="macOverview">
                        <!-- Conte√∫do da categoria MAC ser√° inserido aqui via JavaScript -->
                    </div>

                    <div class="category-section" id="redesOverview">
                        <!-- Conte√∫do da categoria Redes ser√° inserido aqui via JavaScript -->
                    </div>
                </div>

                <div id="ibge" class="tab-content">
                    <div class="indicators-grid" id="ibgeGrid"></div>
                </div>

                <div id="aps" class="tab-content">
                    <div class="indicators-grid" id="apsGrid"></div>
                </div>

                <div id="mac" class="tab-content">
                    <div class="indicators-grid" id="macGrid"></div>
                </div>

                <div id="redes" class="tab-content">
                    <div class="indicators-grid" id="redesGrid"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Base de dados dos indicadores - CORRIGIDA com datas completas
        const indicadores = [
            // IBGE - Popula√ß√£o
            { 
                categoria: "IBGE", 
                subcategoria: "Popula√ß√£o", 
                indicador: "N√∫mero de habitantes", 
                valor: "217.635", 
                unidade: "habitantes", 
                fonte: "IBGE", 
                icon: "üë•",
                data: "2024-12-31",
                tendencia: "up"
            },
            
            // Aten√ß√£o Prim√°ria (APS)
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Cobertura", indicador: "Cobertura ACS", valor: "89.4%", unidade: "popula√ß√£o cadastrada", fonte: "PEC", icon: "üè†", data: "2025-03-01", tendencia: "up" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Quantidade de ACS", indicador: "ACS Ativos", valor: "312", unidade: "agentes comunit√°rios", fonte: "PEC", icon: "üë®‚Äç‚öïÔ∏è", data: "2025-03-01", tendencia: "stable" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Quantidade de ACS", indicador: "Quantidade de ACS Cobertura", valor: "289", unidade: "agentes em cobertura", fonte: "PEC", icon: "üìã", data: "2025-03-01", tendencia: "up" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Cobertura", indicador: "Cobertura APS", valor: "42", unidade: "equipes ativas", fonte: "PEC", icon: "‚öïÔ∏è", data: "2025-03-01", tendencia: "stable" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Cobertura", indicador: "Cobertura SB", valor: "28", unidade: "equipes de sa√∫de bucal", fonte: "PEC", icon: "ü¶∑", data: "2025-03-01", tendencia: "up" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Quantidade de Equipes", indicador: "ESF", valor: "38", unidade: "equipes de sa√∫de da fam√≠lia", fonte: "PEC", icon: "üë®‚Äç‚öïÔ∏è", data: "2025-03-01", tendencia: "stable" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Quantidade de Equipes", indicador: "EAP", valor: "4", unidade: "equipes de aten√ß√£o prim√°ria", fonte: "PEC", icon: "üë©‚Äç‚öïÔ∏è", data: "2025-03-01", tendencia: "stable" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Quantidade de Equipes", indicador: "ESB", valor: "28", unidade: "equipes de sa√∫de bucal", fonte: "PEC", icon: "ü¶∑", data: "2025-03-01", tendencia: "up" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Quantidade de Equipes", indicador: "Emult", valor: "12", unidade: "equipes multiprofissionais", fonte: "PEC", icon: "üë•", data: "2025-03-01", tendencia: "up" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Quantidade de Equipes", indicador: "EAPP", valor: "2", unidade: "equipes de aten√ß√£o prim√°ria prisional", fonte: "PEC", icon: "üè†", data: "2025-03-01", tendencia: "stable" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Consultas", indicador: "Consultas M√©dicas", valor: "8.247", unidade: "consultas realizadas", fonte: "PEC", icon: "üë®‚Äç‚öïÔ∏è", data: "2025-02-01", tendencia: "up" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Consultas", indicador: "Consultas Enfermagem", valor: "6.891", unidade: "consultas de enfermagem", fonte: "PEC", icon: "üë©‚Äç‚öïÔ∏è", data: "2025-02-01", tendencia: "up" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Atendimentos", indicador: "Atend. Multiprofissional", valor: "3.456", unidade: "atendimentos realizados", fonte: "PEC", icon: "üë•", data: "2025-02-01", tendencia: "up" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Programas Espec√≠ficos", indicador: "Pr√©-natal", valor: "1.834", unidade: "gestantes acompanhadas", fonte: "PEC", icon: "ü§∞", data: "2025-02-01", tendencia: "up" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Programas Espec√≠ficos", indicador: "Preventivos Realizados", valor: "2.167", unidade: "exames realizados", fonte: "PEC", icon: "üî¨", data: "2025-02-01", tendencia: "up" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Programas Espec√≠ficos", indicador: "Preventivos Solicitados", valor: "2.890", unidade: "exames solicitados", fonte: "PEC", icon: "üìù", data: "2025-02-01", tendencia: "up" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Programas Espec√≠ficos", indicador: "Preventivos Avaliados", valor: "2.045", unidade: "exames avaliados", fonte: "PEC", icon: "‚úÖ", data: "2025-02-01", tendencia: "up" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Programas Espec√≠ficos", indicador: "Puericultura", valor: "3.278", unidade: "crian√ßas acompanhadas", fonte: "PEC", icon: "üë∂", data: "2025-02-01", tendencia: "up" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Programas Espec√≠ficos", indicador: "Sa√∫de do Idoso", valor: "5.134", unidade: "idosos acompanhados", fonte: "PEC", icon: "üë¥", data: "2025-02-01", tendencia: "up" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Doen√ßas Cr√¥nicas", indicador: "Hipertensos", valor: "12.456", unidade: "pacientes cadastrados", fonte: "PEC", icon: "‚ù§Ô∏è", data: "2025-02-01", tendencia: "up" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Doen√ßas Cr√¥nicas", indicador: "Diab√©ticos", valor: "4.789", unidade: "pacientes cadastrados", fonte: "PEC", icon: "ü©∏", data: "2025-02-01", tendencia: "up" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Preven√ß√£o", indicador: "Cobertura Vacinal", valor: "91.7%", unidade: "poliomielite + influenza", fonte: "PEC", icon: "üíâ", data: "2025-02-01", tendencia: "up" },
            { categoria: "Aten√ß√£o Prim√°ria (APS)", subcategoria: "Inova√ß√£o", indicador: "Teleconsultas", valor: "1.567", unidade: "teleconsultas realizadas", fonte: "PEC", icon: "üíª", data: "2025-02-01", tendencia: "up" },

            // M√©dia e Alta Complexidade (MAC)
            { categoria: "M√©dia e Alta Complexidade (MAC)", subcategoria: "Regula√ß√£o", indicador: "Tempo M√©dio Espera", valor: "28", unidade: "dias para consultas especializadas", fonte: "DIRCA", icon: "‚è±Ô∏è", data: "2025-02-01", tendencia: "down" },
            { categoria: "M√©dia e Alta Complexidade (MAC)", subcategoria: "Especialidades", indicador: "Cardiologia", valor: "567", unidade: "consultas realizadas", fonte: "PEC", icon: "‚ù§Ô∏è", data: "2025-02-01", tendencia: "up" },
            { categoria: "M√©dia e Alta Complexidade (MAC)", subcategoria: "Especialidades", indicador: "Dermatologia", valor: "423", unidade: "consultas realizadas", fonte: "PEC", icon: "üß¥", data: "2025-02-01", tendencia: "up" },
            { categoria: "M√©dia e Alta Complexidade (MAC)", subcategoria: "Especialidades", indicador: "Psiquiatria", valor: "234", unidade: "consultas realizadas", fonte: "PEC", icon: "üß†", data: "2025-02-01", tendencia: "up" },
            { categoria: "M√©dia e Alta Complexidade (MAC)", subcategoria: "Exames", indicador: "Raio-X", valor: "1.234", unidade: "exames realizados", fonte: "PEC", icon: "üì∑", data: "2025-02-01", tendencia: "up" },
            { categoria: "M√©dia e Alta Complexidade (MAC)", subcategoria: "Exames", indicador: "Ultrassonografia", valor: "890", unidade: "exames realizados", fonte: "PEC", icon: "üîç", data: "2025-02-01", tendencia: "up" },
            { categoria: "M√©dia e Alta Complexidade (MAC)", subcategoria: "Exames", indicador: "Tomografia", valor: "156", unidade: "exames realizados", fonte: "SIA", icon: "üè•", data: "2025-02-01", tendencia: "up" },
            { categoria: "M√©dia e Alta Complexidade (MAC)", subcategoria: "Interna√ß√£o", indicador: "Cirurgias Eletivas", valor: "78", unidade: "procedimentos realizados", fonte: "HGP", icon: "üî™", data: "2025-02-20", tendencia: "up" },
            { categoria: "M√©dia e Alta Complexidade (MAC)", subcategoria: "Interna√ß√£o", indicador: "Taxa Ocupa√ß√£o Leitos", valor: "82.4%", unidade: "leitos hospitalares ocupados", fonte: "HGP", icon: "üõèÔ∏è", data: "2025-02-01", tendencia: "stable" },
            { categoria: "M√©dia e Alta Complexidade (MAC)", subcategoria: "Interna√ß√£o", indicador: "Tempo M√©dio Interna√ß√£o", valor: "4.2", unidade: "dias (m√©dia geral)", fonte: "HGP", icon: "üìÖ", data: "2025-02-01", tendencia: "down" },
            { categoria: "M√©dia e Alta Complexidade (MAC)", subcategoria: "Urg√™ncia/Emerg√™ncia", indicador: "Atendimentos UPA", valor: "3.567", unidade: "atendimentos realizados", fonte: "PEC", icon: "üö®", data: "2025-02-01", tendencia: "up" },

            // Redes de Aten√ß√£o / Integra√ß√£o
            { categoria: "Redes de Aten√ß√£o / Integra√ß√£o", subcategoria: "Sa√∫de Mental (RAPS)", indicador: "CAPS Atendimentos", valor: "2.145", unidade: "atendimentos realizados", fonte: "PEC", icon: "üß†", data: "2025-02-01", tendencia: "up" },
            { categoria: "Redes de Aten√ß√£o / Integra√ß√£o", subcategoria: "Sa√∫de Mental (RAPS)", indicador: "Leitos Psiqui√°tricos", valor: "24", unidade: "leitos dispon√≠veis", fonte: "PEC", icon: "üõèÔ∏è", data: "2025-02-01", tendencia: "stable" },
            { categoria: "Redes de Aten√ß√£o / Integra√ß√£o", subcategoria: "Sa√∫de Mental (RAPS)", indicador: "Acolhimentos Crise", valor: "189", unidade: "acolhimentos realizados", fonte: "PEC", icon: "ü§ù", data: "2025-02-01", tendencia: "up" },
            { categoria: "Redes de Aten√ß√£o / Integra√ß√£o", subcategoria: "Sa√∫de da Mulher/Crian√ßa", indicador: "Partos Normais", valor: "1.456", unidade: "partos realizados", fonte: "SAI", icon: "üë∂", data: "2025-02-01", tendencia: "stable" },
            { categoria: "Redes de Aten√ß√£o / Integra√ß√£o", subcategoria: "Sa√∫de da Mulher/Crian√ßa", indicador: "Mortalidade Infantil", valor: "8.9", unidade: "por 1000 nascidos vivos", fonte: "SIM", icon: "üëº", data: "2024-12-31", tendencia: "down" },
            { categoria: "Redes de Aten√ß√£o / Integra√ß√£o", subcategoria: "Sa√∫de da Mulher/Crian√ßa", indicador: "Mortalidade Materna", valor: "2", unidade: "√≥bitos registrados", fonte: "SIM", icon: "üò¢", data: "2024-12-31", tendencia: "down" },
            { categoria: "Redes de Aten√ß√£o / Integra√ß√£o", subcategoria: "Urg√™ncia", indicador: "Tempo Resposta SAMU", valor: "12.5", unidade: "minutos (tempo m√©dio)", fonte: "SAMU", icon: "üöë", data: "2025-02-01", tendencia: "down" }
        ];

        // Cache de elementos DOM para melhor performance
        const domElements = {
            currentTime: document.getElementById('currentTime'),
            categoryFilter: document.getElementById('categoryFilter'),
            subcategoryFilter: document.getElementById('subcategoryFilter'),
            sourceFilter: document.getElementById('sourceFilter'),
            dateFilter: document.getElementById('dateFilter'),
            searchFilter: document.getElementById('searchFilter'),
            filterStats: document.getElementById('filterStats'),
            loadingState: document.getElementById('loadingState'),
            noResults: document.getElementById('noResults'),
            overviewGrid: document.getElementById('overviewGrid'),
            ibgeOverview: document.getElementById('ibgeOverview'),
            apsOverview: document.getElementById('apsOverview'),
            macOverview: document.getElementById('macOverview'),
            redesOverview: document.getElementById('redesOverview'),
            ibgeGrid: document.getElementById('ibgeGrid'),
            apsGrid: document.getElementById('apsGrid'),
            macGrid: document.getElementById('macGrid'),
            redesGrid: document.getElementById('redesGrid')
        };

        let dadosFiltrados = [...indicadores];
        let abaAtual = 'overview';
        let searchTimeout;

        // Fun√ß√£o para atualizar o timestamp
        function updateTimestamp() {
            const agora = new Date();
            const opcoes = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric', 
                hour: '2-digit', 
                minute: '2-digit',
                timeZone: 'America/Sao_Paulo'
            };
            domElements.currentTime.textContent = agora.toLocaleDateString('pt-BR', opcoes);
        }

        // Fun√ß√£o para trocar de aba
        function switchTab(tabId, buttonElement) {
            // Remover classe active de todos os conte√∫dos e bot√µes
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            
            // Adicionar classe active ao conte√∫do e bot√£o selecionados
            document.getElementById(tabId).classList.add('active');
            buttonElement.classList.add('active');
            
            abaAtual = tabId;
            
            if (tabId === 'overview') {
                renderizarVisaoGeral();
            } else {
                renderizarIndicadores();
            }
        }

        // Fun√ß√£o para criar um card de indicador
        function criarCardIndicador(indicador) {
            const categoriaClass = `categoria-${indicador.categoria.toLowerCase().replace(/[^a-z]/g, '').substring(0, 10)}`;
            
            return `
                <div class="indicator-card ${categoriaClass}">
                    <div class="card-subcategory">${indicador.subcategoria}</div>
                    <div class="card-header">
                        <div class="card-title">${indicador.indicador}</div>
                        <div class="card-icon">${indicador.icon}</div>
                    </div>
                    <div class="card-value">${indicador.valor}</div>
                    <div class="card-unit">${indicador.unidade}</div>
                    <div class="card-source">Fonte: ${indicador.fonte}${indicador.data ? ` | ${formatarData(indicador.data)}` : ''}</div>
                </div>
            `;
        }

        // Fun√ß√£o para criar um card de vis√£o geral
        function criarCardVisaoGeral(indicador) {
            let trendIcon = '';
            let trendClass = '';
            
            if (indicador.tendencia === 'up') {
                trendIcon = '‚ÜóÔ∏è';
                trendClass = 'trend-up';
            } else if (indicador.tendencia === 'down') {
                trendIcon = '‚ÜòÔ∏è';
                trendClass = 'trend-down';
            } else {
                trendIcon = '‚û°Ô∏è';
                trendClass = 'trend-stable';
            }
            
            return `
                <div class="overview-card">
                    <div class="overview-icon">${indicador.icon}</div>
                    <div class="overview-title">${indicador.indicador}</div>
                    <div class="overview-value">${indicador.valor}</div>
                    <div class="overview-unit">${indicador.unidade}</div>
                    <div class="trend-indicator ${trendClass}">${trendIcon} Tend√™ncia</div>
                </div>
            `;
        }

        // Fun√ß√£o para criar se√ß√£o de categoria na vis√£o geral
        function criarSecaoCategoria(categoria, icone, indicadoresCategoria) {
            let html = `
                <div class="category-title">
                    <span class="category-icon">${icone}</span>
                    ${categoria}
                </div>
                <div class="indicators-grid">
            `;
            
            indicadoresCategoria.forEach(indicador => {
                html += criarCardIndicador(indicador);
            });
            
            html += `</div>`;
            
            return html;
        }

        // Fun√ß√£o para formatar data
        function formatarData(dataString) {
            if (!dataString) return '';
            const data = new Date(dataString);
            return data.toLocaleDateString('pt-BR');
        }

        // Fun√ß√£o para renderizar vis√£o geral
        function renderizarVisaoGeral() {
            // Limpar containers
            domElements.overviewGrid.innerHTML = '';
            domElements.ibgeOverview.innerHTML = '';
            domElements.apsOverview.innerHTML = '';
            domElements.macOverview.innerHTML = '';
            domElements.redesOverview.innerHTML = '';
            
            // Selecionar indicadores principais para cards de resumo
            const indicadoresResumo = [
                indicadores.find(ind => ind.indicador === "N√∫mero de habitantes"),
                indicadores.find(ind => ind.indicador === "Cobertura ACS"),
                indicadores.find(ind => ind.indicador === "Consultas M√©dicas"),
                indicadores.find(ind => ind.indicador === "Taxa Ocupa√ß√£o Leitos"),
                indicadores.find(ind => ind.indicador === "CAPS Atendimentos"),
                indicadores.find(ind => ind.indicador === "Mortalidade Infantil")
            ].filter(Boolean);
            
            // Renderizar cards de resumo
            indicadoresResumo.forEach(indicador => {
                domElements.overviewGrid.innerHTML += criarCardVisaoGeral(indicador);
            });
            
            // Renderizar se√ß√µes por categoria
            const indicadoresIBGE = dadosFiltrados.filter(ind => ind.categoria === "IBGE");
            const indicadoresAPS = dadosFiltrados.filter(ind => ind.categoria === "Aten√ß√£o Prim√°ria (APS)");
            const indicadoresMAC = dadosFiltrados.filter(ind => ind.categoria === "M√©dia e Alta Complexidade (MAC)");
            const indicadoresRedes = dadosFiltrados.filter(ind => ind.categoria === "Redes de Aten√ß√£o / Integra√ß√£o");
            
            if (indicadoresIBGE.length > 0) {
                domElements.ibgeOverview.innerHTML = criarSecaoCategoria("Popula√ß√£o (IBGE)", "üìä", indicadoresIBGE);
            }
            
            if (indicadoresAPS.length > 0) {
                domElements.apsOverview.innerHTML = criarSecaoCategoria("Aten√ß√£o Prim√°ria (APS)", "üè°", indicadoresAPS);
            }
            
            if (indicadoresMAC.length > 0) {
                domElements.macOverview.innerHTML = criarSecaoCategoria("M√©dia e Alta Complexidade (MAC)", "üè•", indicadoresMAC);
            }
            
            if (indicadoresRedes.length > 0) {
                domElements.redesOverview.innerHTML = criarSecaoCategoria("Redes de Aten√ß√£o / Integra√ß√£o", "üîó", indicadoresRedes);
            }
            
            atualizarEstatisticasFiltros();
        }

        // Fun√ß√£o para renderizar indicadores
        function renderizarIndicadores() {
            const containers = {
                'ibge': domElements.ibgeGrid,
                'aps': domElements.apsGrid,
                'mac': domElements.macGrid,
                'redes': domElements.redesGrid
            };

            // Limpar todos os containers
            Object.values(containers).forEach(container => {
                if (container) container.innerHTML = '';
            });

            const mapeamentoCategoria = {
                'IBGE': 'ibge',
                'Aten√ß√£o Prim√°ria (APS)': 'aps',
                'M√©dia e Alta Complexidade (MAC)': 'mac',
                'Redes de Aten√ß√£o / Integra√ß√£o': 'redes'
            };

            let temResultados = false;

            dadosFiltrados.forEach(indicador => {
                const containerKey = mapeamentoCategoria[indicador.categoria];
                const container = containers[containerKey];
                
                if (container) {
                    container.innerHTML += criarCardIndicador(indicador);
                    temResultados = true;
                }
            });

            // Mostrar/ocultar mensagem de sem resultados
            if (temResultados) {
                domElements.noResults.classList.remove('show');
            } else {
                domElements.noResults.classList.add('show');
            }

            atualizarEstatisticasFiltros();
        }

        // Fun√ß√£o para filtrar indicadores
        function filtrarIndicadores() {
            const filtroCategoria = domElements.categoryFilter.value;
            const filtroSubcategoria = domElements.subcategoryFilter.value;
            const filtroFonte = domElements.sourceFilter.value;
            const filtroData = domElements.dateFilter.value;
            const filtroBusca = domElements.searchFilter.value.toLowerCase();

            // Mostrar loading
            domElements.loadingState.classList.add('show');

            // Usar setTimeout para dar tempo da anima√ß√£o de loading aparecer
            setTimeout(() => {
                try {
                    dadosFiltrados = indicadores.filter(ind => {
                        const correspondeCategoria = !filtroCategoria || ind.categoria === filtroCategoria;
                        const correspondeSubcategoria = !filtroSubcategoria || ind.subcategoria === filtroSubcategoria;
                        const correspondeFonte = !filtroFonte || ind.fonte.includes(filtroFonte);
                        const correspondeData = !filtroData || ind.data === filtroData;
                        const correspondeBusca = !filtroBusca || 
                            ind.indicador.toLowerCase().includes(filtroBusca) ||
                            ind.categoria.toLowerCase().includes(filtroBusca) ||
                            ind.subcategoria.toLowerCase().includes(filtroBusca) ||
                            ind.unidade.toLowerCase().includes(filtroBusca);
                        
                        return correspondeCategoria && correspondeSubcategoria && correspondeFonte && correspondeData && correspondeBusca;
                    });

                    if (abaAtual === 'overview') {
                        renderizarVisaoGeral();
                    } else {
                        renderizarIndicadores();
                    }
                    
                    atualizarSubcategorias();
                } catch (error) {
                    console.error('Erro ao filtrar indicadores:', error);
                } finally {
                    domElements.loadingState.classList.remove('show');
                }
            }, 300);
        }

        // Fun√ß√£o para atualizar estat√≠sticas de filtros
        function atualizarEstatisticasFiltros() {
            const total = dadosFiltrados.length;
            const totalOriginal = indicadores.length;
            
            if (total === totalOriginal) {
                domElements.filterStats.innerHTML = `üìä Mostrando todos os <strong>${total}</strong> indicadores de sa√∫de`;
            } else {
                domElements.filterStats.innerHTML = `üìä Mostrando <strong>${total}</strong> de <strong>${totalOriginal}</strong> indicadores de sa√∫de`;
            }
        }

        // Fun√ß√£o para atualizar filtro de subcategorias
        function atualizarSubcategorias() {
            const filtroCategoria = domElements.categoryFilter.value;
            
            // Limpar op√ß√µes existentes
            domElements.subcategoryFilter.innerHTML = '<option value="">Todas as Sub-categorias</option>';
            
            if (filtroCategoria) {
                const subcategorias = [...new Set(
                    indicadores
                        .filter(ind => ind.categoria === filtroCategoria)
                        .map(ind => ind.subcategoria)
                )].sort();
                
                subcategorias.forEach(sub => {
                    domElements.subcategoryFilter.innerHTML += `<option value="${sub}">${sub}</option>`;
                });
            } else {
                // Se n√£o h√° categoria selecionada, mostrar todas as subcategorias
                const todasSubcategorias = [...new Set(indicadores.map(ind => ind.subcategoria))].sort();
                todasSubcategorias.forEach(sub => {
                    domElements.subcategoryFilter.innerHTML += `<option value="${sub}">${sub}</option>`;
                });
            }
        }

        // Fun√ß√£o para limpar todos os filtros
        function clearAllFilters() {
            domElements.categoryFilter.value = '';
            domElements.subcategoryFilter.value = '';
            domElements.sourceFilter.value = '';
            domElements.dateFilter.value = '';
            domElements.searchFilter.value = '';
            
            filtrarIndicadores();
        }

        // Fun√ß√£o com debounce para busca
        function debounce(func, wait) {
            return function executedFunction(...args) {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => func.apply(this, args), wait);
            };
        }

        // Event listeners para filtros
        domElements.categoryFilter.addEventListener('change', function() {
            domElements.subcategoryFilter.value = '';
            filtrarIndicadores();
        });

        domElements.subcategoryFilter.addEventListener('change', filtrarIndicadores);
        domElements.sourceFilter.addEventListener('change', filtrarIndicadores);
        domElements.dateFilter.addEventListener('change', filtrarIndicadores);
        
        // Aplicar debounce na busca para melhor performance
        domElements.searchFilter.addEventListener('input', debounce(filtrarIndicadores, 300));

        // Inicializa√ß√£o da aplica√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Dashboard de Sa√∫de P√∫blica inicializado com sucesso!');
            console.log(`Total de indicadores carregados: ${indicadores.length}`);
            
            updateTimestamp();
            atualizarSubcategorias(); // Inicializar subcategorias
            renderizarVisaoGeral(); // Iniciar com a vis√£o geral
            atualizarEstatisticasFiltros();
            
            // Atualizar timestamp a cada minuto
            setInterval(updateTimestamp, 60000);
        });
    </script>
</body>
</html>
